Lab 10
================
Lily Shkhyan
2022-11-02

``` r
if(!require(RSQLite)) install.packages(c("RSQLite"))
```

    ## Loading required package: RSQLite

``` r
if(!require(DBI)) install.packages(c("DBI"))
```

    ## Loading required package: DBI

``` r
library(RSQLite)
library(DBI)
```

## Data Setup

``` r
# Initialize a temporary in memory database
con <- dbConnect(SQLite(), ":memory:")

# Download tables
actor <- read.csv("https://raw.githubusercontent.com/ivanceras/sakila/master/csv-sakila-db/actor.csv")
rental <- read.csv("https://raw.githubusercontent.com/ivanceras/sakila/master/csv-sakila-db/rental.csv")
customer <- read.csv("https://raw.githubusercontent.com/ivanceras/sakila/master/csv-sakila-db/customer.csv")
payment <- read.csv("https://raw.githubusercontent.com/ivanceras/sakila/master/csv-sakila-db/payment_p2007_01.csv")

# Copy data.frames to database
dbWriteTable(con, "actor", actor)
dbWriteTable(con, "rental", rental)
dbWriteTable(con, "customer", customer)
dbWriteTable(con, "payment", payment)
dbListTables(con)
```

    ## [1] "actor"    "customer" "payment"  "rental"

``` sql
PRAGMA table_info(actor)
```

``` r
x1
```

    ##   cid        name    type notnull dflt_value pk
    ## 1   0    actor_id INTEGER       0         NA  0
    ## 2   1  first_name    TEXT       0         NA  0
    ## 3   2   last_name    TEXT       0         NA  0
    ## 4   3 last_update    TEXT       0         NA  0

``` sql
PRAGMA table_info(actor)
```

| cid | name        | type    | notnull | dflt_value |  pk |
|:----|:------------|:--------|--------:|:-----------|----:|
| 0   | actor_id    | INTEGER |       0 | NA         |   0 |
| 1   | first_name  | TEXT    |       0 | NA         |   0 |
| 2   | last_name   | TEXT    |       0 | NA         |   0 |
| 3   | last_update | TEXT    |       0 | NA         |   0 |

4 records

``` r
dbGetQuery(con, "PRAGMA table_info(actor)"
)
```

    ##   cid        name    type notnull dflt_value pk
    ## 1   0    actor_id INTEGER       0         NA  0
    ## 2   1  first_name    TEXT       0         NA  0
    ## 3   2   last_name    TEXT       0         NA  0
    ## 4   3 last_update    TEXT       0         NA  0

# Exercise 1

``` r
dbGetQuery(con, "
SELECT actor_id, first_name, last_name
FROM actor
ORDER BY last_name, first_name
LIMIT 15
")
```

    ##    actor_id first_name last_name
    ## 1        58  CHRISTIAN    AKROYD
    ## 2       182     DEBBIE    AKROYD
    ## 3        92    KIRSTEN    AKROYD
    ## 4       118       CUBA     ALLEN
    ## 5       145        KIM     ALLEN
    ## 6       194      MERYL     ALLEN
    ## 7        76   ANGELINA   ASTAIRE
    ## 8       112    RUSSELL    BACALL
    ## 9       190     AUDREY    BAILEY
    ## 10       67    JESSICA    BAILEY
    ## 11      115   HARRISON      BALE
    ## 12      187      RENEE      BALL
    ## 13       47      JULIA BARRYMORE
    ## 14      158     VIVIEN  BASINGER
    ## 15      174    MICHAEL    BENING

Try in SQL

``` sql
SELECT actor_id, first_name, last_name
FROM actor
ORDER BY last_name, first_name
```

| actor_id | first_name | last_name |
|---------:|:-----------|:----------|
|       58 | CHRISTIAN  | AKROYD    |
|      182 | DEBBIE     | AKROYD    |
|       92 | KIRSTEN    | AKROYD    |
|      118 | CUBA       | ALLEN     |
|      145 | KIM        | ALLEN     |
|      194 | MERYL      | ALLEN     |
|       76 | ANGELINA   | ASTAIRE   |
|      112 | RUSSELL    | BACALL    |
|      190 | AUDREY     | BAILEY    |
|       67 | JESSICA    | BAILEY    |

Displaying records 1 - 10

# Exercise 2

``` r
dbGetQuery(con, "
SELECT actor_id, first_name, last_name
FROM actor
WHERE last_name IN ('WILLIAMS', 'DAVIS')
ORDER BY last_name
")
```

    ##   actor_id first_name last_name
    ## 1        4   JENNIFER     DAVIS
    ## 2      101      SUSAN     DAVIS
    ## 3      110      SUSAN     DAVIS
    ## 4       72       SEAN  WILLIAMS
    ## 5      137     MORGAN  WILLIAMS
    ## 6      172    GROUCHO  WILLIAMS

# Exercise 3

``` r
dbGetQuery(con, "PRAGMA table_info(rental)"
)
```

    ##   cid         name    type notnull dflt_value pk
    ## 1   0    rental_id INTEGER       0         NA  0
    ## 2   1  rental_date    TEXT       0         NA  0
    ## 3   2 inventory_id INTEGER       0         NA  0
    ## 4   3  customer_id INTEGER       0         NA  0
    ## 5   4  return_date    TEXT       0         NA  0
    ## 6   5     staff_id INTEGER       0         NA  0
    ## 7   6  last_update    TEXT       0         NA  0

``` r
dbGetQuery(con, "
SELECT distinct customer_id, rental_date
FROM rental
WHERE date(rental_date) = '2005-07-05'
")
```

    ##    customer_id         rental_date
    ## 1          565 2005-07-05 22:49:24
    ## 2          242 2005-07-05 22:51:44
    ## 3           37 2005-07-05 22:56:33
    ## 4           60 2005-07-05 22:57:34
    ## 5          594 2005-07-05 22:59:53
    ## 6            8 2005-07-05 23:01:21
    ## 7          490 2005-07-05 23:02:37
    ## 8          476 2005-07-05 23:05:17
    ## 9          322 2005-07-05 23:05:44
    ## 10         298 2005-07-05 23:08:53
    ## 11         382 2005-07-05 23:11:43
    ## 12         138 2005-07-05 23:13:07
    ## 13         520 2005-07-05 23:13:22
    ## 14         536 2005-07-05 23:13:51
    ## 15         114 2005-07-05 23:23:11
    ## 16         111 2005-07-05 23:25:54
    ## 17         296 2005-07-05 23:29:55
    ## 18         586 2005-07-05 23:30:36
    ## 19         349 2005-07-05 23:32:49
    ## 20         397 2005-07-05 23:33:40
    ## 21         369 2005-07-05 23:37:13
    ## 22         421 2005-07-05 23:41:08
    ## 23         142 2005-07-05 23:44:37
    ## 24         169 2005-07-05 23:46:19
    ## 25         348 2005-07-05 23:47:30
    ## 26         553 2005-07-05 23:50:04
    ## 27         295 2005-07-05 23:59:15

``` r
dbGetQuery(con, "
SELECT customer_id, Count(*) AS N
FROM rental
WHERE date(rental_date) = '2005-07-05'
GROUP BY customer_id
")
```

    ##    customer_id N
    ## 1            8 1
    ## 2           37 1
    ## 3           60 1
    ## 4          111 1
    ## 5          114 1
    ## 6          138 1
    ## 7          142 1
    ## 8          169 1
    ## 9          242 1
    ## 10         295 1
    ## 11         296 1
    ## 12         298 1
    ## 13         322 1
    ## 14         348 1
    ## 15         349 1
    ## 16         369 1
    ## 17         382 1
    ## 18         397 1
    ## 19         421 1
    ## 20         476 1
    ## 21         490 1
    ## 22         520 1
    ## 23         536 1
    ## 24         553 1
    ## 25         565 1
    ## 26         586 1
    ## 27         594 1

# Exercise 4

``` r
dbGetQuery(con, "PRAGMA table_info(payment)"
)
```

    ##   cid         name    type notnull dflt_value pk
    ## 1   0   payment_id INTEGER       0         NA  0
    ## 2   1  customer_id INTEGER       0         NA  0
    ## 3   2     staff_id INTEGER       0         NA  0
    ## 4   3    rental_id INTEGER       0         NA  0
    ## 5   4       amount    REAL       0         NA  0
    ## 6   5 payment_date    TEXT       0         NA  0

### Exercise 4.1

``` r
dbGetQuery(con, "
SELECT *
FROM payment
WHERE amount IN (1.99, 7.99, 9.99)
ORDER BY amount
")
```

    ##     payment_id customer_id staff_id rental_id amount               payment_date
    ## 1        16050         269        2         7   1.99 2007-01-24 21:40:19.996577
    ## 2        16056         270        1       193   1.99 2007-01-26 05:10:14.996577
    ## 3        16081         282        2        48   1.99 2007-01-25 04:49:12.996577
    ## 4        16103         294        1       595   1.99 2007-01-28 12:28:20.996577
    ## 5        16133         307        1       614   1.99 2007-01-28 14:01:54.996577
    ## 6        16158         316        1      1065   1.99 2007-01-31 07:23:22.996577
    ## 7        16206         351        1      1137   1.99 2007-01-31 17:48:40.996577
    ## 8        16210         354        2       158   1.99 2007-01-25 23:55:37.996577
    ## 9        16302         400        2       516   1.99 2007-01-28 01:40:13.996577
    ## 10       16306         401        2       811   1.99 2007-01-29 17:59:08.996577
    ## 11       16307         402        2       801   1.99 2007-01-29 16:04:16.996577
    ## 12       16320         411        2       972   1.99 2007-01-30 18:49:33.996577
    ## 13       16400         452        1       726   1.99 2007-01-29 04:33:55.996577
    ## 14       16414         463        1       560   1.99 2007-01-28 07:21:28.996577
    ## 15       16416         464        2       373   1.99 2007-01-27 06:44:51.996577
    ## 16       16428         469        2       936   1.99 2007-01-30 12:21:15.996577
    ## 17       16484         501        1       605   1.99 2007-01-28 13:07:36.996577
    ## 18       16489         503        2       109   1.99 2007-01-25 17:08:46.996577
    ## 19       16521         516        1       571   1.99 2007-01-28 08:46:07.996577
    ## 20       16546         533        2       190   1.99 2007-01-26 04:39:54.996577
    ## 21       16566         543        2       476   1.99 2007-01-27 21:00:02.996577
    ## 22       16575         547        2      1094   1.99 2007-01-31 11:32:15.996577
    ## 23       16615         569        1       647   1.99 2007-01-28 17:51:18.996577
    ## 24       16659         596        2       782   1.99 2007-01-29 13:07:23.996577
    ## 25       16669         204        1      1016   1.99 2007-01-31 01:18:09.996577
    ## 26       16680           3        1       435   1.99 2007-01-27 15:45:35.996577
    ## 27       16684           5        1      1142   1.99 2007-01-31 18:15:04.996577
    ## 28       16724          20        2       546   1.99 2007-01-28 05:44:51.996577
    ## 29       16743          29        2       194   1.99 2007-01-26 05:20:59.996577
    ## 30       16773          49        2        96   1.99 2007-01-25 15:00:45.996577
    ## 31       16811          60        2       706   1.99 2007-01-29 01:34:15.996577
    ## 32       16825          69        2       765   1.99 2007-01-29 10:07:00.996577
    ## 33       16837          76        2       574   1.99 2007-01-28 09:12:54.996577
    ## 34       16840          77        1       419   1.99 2007-01-27 13:43:37.996577
    ## 35       16858          86        1        66   1.99 2007-01-25 08:03:38.996577
    ## 36       16880         102        2       562   1.99 2007-01-28 07:29:47.996577
    ## 37       16903         110        2       538   1.99 2007-01-28 04:49:31.996577
    ## 38       16990         159        2       549   1.99 2007-01-28 06:04:03.996577
    ## 39       16999         162        1       285   1.99 2007-01-26 18:10:06.996577
    ## 40       17002         164        2      1011   1.99 2007-01-31 00:34:05.996577
    ## 41       17004         166        1       662   1.99 2007-01-28 19:37:57.996577
    ## 42       17026         176        1       663   1.99 2007-01-28 19:51:28.996577
    ## 43       17038         184        1       567   1.99 2007-01-28 08:24:46.996577
    ## 44       17042         186        1       581   1.99 2007-01-28 09:48:55.996577
    ## 45       17050         192        1       895   1.99 2007-01-30 07:19:09.996577
    ## 46       17058         196        1      1053   1.99 2007-01-31 05:41:10.996577
    ## 47       17062         197        2       649   1.99 2007-01-28 18:04:11.996577
    ## 48       17083         214        1       242   1.99 2007-01-26 11:33:34.996577
    ## 49       17142         244        1       797   1.99 2007-01-29 15:40:43.996577
    ## 50       17169         251        1       309   1.99 2007-01-26 21:06:36.996577
    ## 51       17201         266        1        86   1.99 2007-01-25 12:04:38.996577
    ## 52       16180         330        2       967   7.99 2007-01-30 17:40:32.996577
    ## 53       16240         369        2       913   7.99 2007-01-30 09:33:24.996577
    ## 54       16275         386        1       583   7.99 2007-01-28 10:17:21.996577
    ## 55       16277         387        1       697   7.99 2007-01-29 00:32:30.996577
    ## 56       16289         391        1       891   7.99 2007-01-30 06:11:38.996577
    ## 57       16314         407        1       619   7.99 2007-01-28 14:20:52.996577
    ## 58       16348         429        2       601   7.99 2007-01-28 12:36:48.996577
    ## 59       16354         432        2       326   7.99 2007-01-26 23:38:37.996577
    ## 60       16360         435        1       757   7.99 2007-01-29 08:58:13.996577
    ## 61       16362         436        1        45   7.99 2007-01-25 04:28:05.996577
    ## 62       16393         449        1       849   7.99 2007-01-29 23:51:33.996577
    ## 63       16401         454        1       735   7.99 2007-01-29 06:36:39.996577
    ## 64       16405         457        2      1024   7.99 2007-01-31 01:58:45.996577
    ## 65       16426         469        2       506   7.99 2007-01-28 00:37:45.996577
    ## 66       16439         474        1       816   7.99 2007-01-29 18:55:05.996577
    ## 67       16446         479        1       709   7.99 2007-01-29 02:16:27.996577
    ## 68       16469         493        1       543   7.99 2007-01-28 05:12:00.996577
    ## 69       16475         497        1      1100   7.99 2007-01-31 12:31:47.996577
    ## 70       16561         541        1      1021   7.99 2007-01-31 01:44:41.996577
    ## 71       16583         550        2       922   7.99 2007-01-30 10:24:21.996577
    ## 72       16584         551        2       155   7.99 2007-01-25 23:43:31.996577
    ## 73       16617         570        2      1060   7.99 2007-01-31 06:50:09.996577
    ## 74       16620         572        2       559   7.99 2007-01-28 07:07:28.996577
    ## 75       16736          25        1        90   7.99 2007-01-25 12:59:51.996577
    ## 76       16805          58        2       276   7.99 2007-01-26 15:44:33.996577
    ## 77       16881         103        1       240   7.99 2007-01-26 11:08:49.996577
    ## 78       16886         105        2       473   7.99 2007-01-27 20:05:00.996577
    ## 79       16899         109        1      1061   7.99 2007-01-31 06:56:24.996577
    ## 80       16902         110        1       515   7.99 2007-01-28 01:38:36.996577
    ## 81       16922         120        2        68   7.99 2007-01-25 08:15:57.996577
    ## 82       16944         131        2       944   7.99 2007-01-30 13:54:50.996577
    ## 83       16966         146        2       762   7.99 2007-01-29 09:44:17.996577
    ## 84       16980         154        2       865   7.99 2007-01-30 02:08:10.996577
    ## 85       17027         176        1      1062   7.99 2007-01-31 07:06:46.996577
    ## 86       17044         187        1       252   7.99 2007-01-26 13:08:19.996577
    ## 87       17054         194        2       677   7.99 2007-01-28 21:28:34.996577
    ## 88       17072         199        1       499   7.99 2007-01-27 23:33:33.996577
    ## 89       17130         239        1      1022   7.99 2007-01-31 01:45:11.996577
    ## 90       17135         241        1       627   7.99 2007-01-28 15:33:09.996577
    ## 91       17145         245        1       519   7.99 2007-01-28 01:50:59.996577
    ## 92       17157         248        2       330   7.99 2007-01-27 00:43:56.996577
    ## 93       16160         318        1       224   9.99 2007-01-26 08:46:53.996577
    ## 94       16161         319        1        15   9.99 2007-01-24 23:07:48.996577
    ## 95       16373         439        1       786   9.99 2007-01-29 13:45:54.996577
    ## 96       16449         480        2       822   9.99 2007-01-29 20:04:26.996577
    ## 97       16618         571        1       228   9.99 2007-01-26 09:22:54.996577
    ## 98       16702          14        1       346   9.99 2007-01-27 03:03:07.996577
    ## 99       16717          19        2       110   9.99 2007-01-25 17:12:15.996577
    ## 100      16790          53        2       856   9.99 2007-01-30 00:29:47.996577
    ## 101      16796          55        1      1027   9.99 2007-01-31 02:14:45.996577
    ## 102      16802          57        2       152   9.99 2007-01-25 23:09:36.996577
    ## 103      16822          67        2       331   9.99 2007-01-27 00:50:52.996577
    ## 104      16828          71        1       272   9.99 2007-01-26 14:55:37.996577
    ## 105      16856          85        1       690   9.99 2007-01-28 23:23:19.996577
    ## 106      16877         101        1       468   9.99 2007-01-27 19:41:36.996577
    ## 107      16882         103        1       658   9.99 2007-01-28 18:51:49.996577
    ## 108      16960         142        1       575   9.99 2007-01-28 09:24:35.996577
    ## 109      17015         171        2       804   9.99 2007-01-29 16:38:50.996577
    ## 110      17073         200        2       270   9.99 2007-01-26 14:49:22.996577
    ## 111      17077         209        2       340   9.99 2007-01-27 02:23:51.996577

### Exercise 4.2

``` r
dbGetQuery(con, "
SELECT *
FROM payment
WHERE amount > 5
ORDER BY amount
")
```

    ##     payment_id customer_id staff_id rental_id amount               payment_date
    ## 1        16068         274        1       394   5.99 2007-01-27 09:54:37.996577
    ## 2        16094         288        2       565   5.99 2007-01-28 07:54:57.996577
    ## 3        16106         296        1       511   5.99 2007-01-28 01:32:30.996577
    ## 4        16112         299        1       332   5.99 2007-01-27 00:55:36.996577
    ## 5        16118         301        2       227   5.99 2007-01-26 09:20:12.996577
    ## 6        16121         302        2        92   5.99 2007-01-25 14:07:12.996577
    ## 7        16139         311        2       274   5.99 2007-01-26 15:17:17.996577
    ## 8        16152         314        1        80   5.99 2007-01-25 10:40:33.996577
    ## 9        16165         321        1       620   5.99 2007-01-28 14:23:11.996577
    ## 10       16171         323        1       878   5.99 2007-01-30 04:17:39.996577
    ## 11       16173         325        1       131   5.99 2007-01-25 20:11:12.996577
    ## 12       16192         339        1       876   5.99 2007-01-30 04:09:48.996577
    ## 13       16196         344        2       813   5.99 2007-01-29 18:43:00.996577
    ## 14       16223         361        1       368   5.99 2007-01-27 06:10:55.996577
    ## 15       16227         364        1       462   5.99 2007-01-27 18:39:02.996577
    ## 16       16228         365        2       120   5.99 2007-01-25 18:06:13.996577
    ## 17       16233         368        1        64   5.99 2007-01-25 07:49:55.996577
    ## 18       16234         368        1       125   5.99 2007-01-25 19:17:16.996577
    ## 19       16244         371        1       384   5.99 2007-01-27 08:46:46.996577
    ## 20       16287         391        1       317   5.99 2007-01-26 21:52:22.996577
    ## 21       16294         396        2       641   5.99 2007-01-28 17:14:13.996577
    ## 22       16297         399        2        10   5.99 2007-01-24 22:30:47.996577
    ## 23       16303         400        2       894   5.99 2007-01-30 06:59:57.996577
    ## 24       16310         404        2      1081   5.99 2007-01-31 09:24:58.996577
    ## 25       16316         408        2        59   5.99 2007-01-25 07:25:08.996577
    ## 26       16342         425        2      1098   5.99 2007-01-31 12:20:14.996577
    ## 27       16346         429        2       150   5.99 2007-01-25 22:57:05.996577
    ## 28       16355         432        1       550   5.99 2007-01-28 06:07:42.996577
    ## 29       16359         434        2       508   5.99 2007-01-28 01:09:16.996577
    ## 30       16364         436        1       848   5.99 2007-01-29 23:48:19.996577
    ## 31       16367         437        1       666   5.99 2007-01-28 20:17:17.996577
    ## 32       16378         442        1       632   5.99 2007-01-28 16:06:16.996577
    ## 33       16392         449        2       325   5.99 2007-01-26 23:38:21.996577
    ## 34       16450         481        2      1109   5.99 2007-01-31 13:40:41.996577
    ## 35       16490         503        1       353   5.99 2007-01-27 04:32:05.996577
    ## 36       16493         504        2       136   5.99 2007-01-25 20:30:56.996577
    ## 37       16512         510        1       372   5.99 2007-01-27 06:42:24.996577
    ## 38       16526         522        2       426   5.99 2007-01-27 14:25:23.996577
    ## 39       16531         525        1       437   5.99 2007-01-27 16:15:48.996577
    ## 40       16537         528        1       533   5.99 2007-01-28 04:43:12.996577
    ## 41       16539         528        2       793   5.99 2007-01-29 15:12:34.996577
    ## 42       16547         533        1       615   5.99 2007-01-28 14:04:18.996577
    ## 43       16548         534        2       304   5.99 2007-01-26 19:49:54.996577
    ## 44       16571         546        1       197   5.99 2007-01-26 05:27:47.996577
    ## 45       16594         556        2       772   5.99 2007-01-29 11:36:32.996577
    ## 46       16603         562        1      1139   5.99 2007-01-31 18:03:18.996577
    ## 47       16605         563        2       773   5.99 2007-01-29 11:46:31.996577
    ## 48       16606         564        2       195   5.99 2007-01-26 05:21:02.996577
    ## 49       16610         566        2       234   5.99 2007-01-26 10:15:46.996577
    ## 50       16630         577        2       291   5.99 2007-01-26 18:49:13.996577
    ## 51       16688           7        2        46   5.99 2007-01-25 04:32:34.996577
    ## 52       16692           7        1      1063   5.99 2007-01-31 07:12:55.996577
    ## 53       16703          14        1       525   5.99 2007-01-28 02:53:59.996577
    ## 54       16755          42        1       635   5.99 2007-01-28 16:15:23.996577
    ## 55       16789          53        2       783   5.99 2007-01-29 13:09:44.996577
    ## 56       16799          56        1       341   5.99 2007-01-27 02:30:08.996577
    ## 57       16809          59        1      1154   5.99 2007-01-31 20:10:35.996577
    ## 58       16843          77        1       760   5.99 2007-01-29 09:35:51.996577
    ## 59       16864          89        1       740   5.99 2007-01-29 06:59:02.996577
    ## 60       16865          91        2       216   5.99 2007-01-26 07:46:09.996577
    ## 61       16866          92        1       271   5.99 2007-01-26 14:50:27.996577
    ## 62       16891         107        1       170   5.99 2007-01-26 01:39:38.996577
    ## 63       16892         107        1      1026   5.99 2007-01-31 02:13:52.996577
    ## 64       16895         109        1       203   5.99 2007-01-26 05:56:23.996577
    ## 65       16918         118        2       351   5.99 2007-01-27 04:07:29.996577
    ## 66       16920         119        1       235   5.99 2007-01-26 10:19:35.996577
    ## 67       16931         124        2      1130   5.99 2007-01-31 16:42:23.996577
    ## 68       16938         128        2       888   5.99 2007-01-30 05:41:40.996577
    ## 69       16951         135        1        78   5.99 2007-01-25 10:03:44.996577
    ## 70       16976         151        2       418   5.99 2007-01-27 13:41:43.996577
    ## 71       16979         154        1       469   5.99 2007-01-27 19:42:52.996577
    ## 72       16981         154        2       978   5.99 2007-01-30 19:59:18.996577
    ## 73       16988         158        1       293   5.99 2007-01-26 18:55:28.996577
    ## 74       16995         161        1       520   5.99 2007-01-28 01:56:03.996577
    ## 75       17013         170        1       377   5.99 2007-01-27 07:32:31.996577
    ## 76       17021         174        1        41   5.99 2007-01-25 03:40:55.996577
    ## 77       17045         189        2      1117   5.99 2007-01-31 14:43:57.996577
    ## 78       17056         196        2       178   5.99 2007-01-26 02:50:12.996577
    ## 79       17076         201        2       756   5.99 2007-01-29 08:57:11.996577
    ## 80       17111         231        1       329   5.99 2007-01-27 00:25:40.996577
    ## 81       17131         239        2      1082   5.99 2007-01-31 09:30:27.996577
    ## 82       17151         246        2       434   5.99 2007-01-27 15:22:53.996577
    ## 83       17163         250        1        61   5.99 2007-01-25 07:30:23.996577
    ## 84       17180         254        1      1108   5.99 2007-01-31 13:33:38.996577
    ## 85       17191         259        1      1147   5.99 2007-01-31 19:06:18.996577
    ## 86       16052         269        2       678   6.99 2007-01-28 21:44:14.996577
    ## 87       16060         272        1       405   6.99 2007-01-27 12:01:05.996577
    ## 88       16061         272        1      1041   6.99 2007-01-31 04:14:49.996577
    ## 89       16074         277        2       308   6.99 2007-01-26 20:30:05.996577
    ## 90       16082         282        2       282   6.99 2007-01-26 17:24:52.996577
    ## 91       16086         284        1      1145   6.99 2007-01-31 18:42:11.996577
    ## 92       16087         286        2        81   6.99 2007-01-25 10:43:45.996577
    ## 93       16092         288        2       427   6.99 2007-01-27 14:38:30.996577
    ## 94       16130         306        2       672   6.99 2007-01-28 20:33:55.996577
    ## 95       16134         307        1       970   6.99 2007-01-30 18:18:54.996577
    ## 96       16136         309        2       218   6.99 2007-01-26 07:55:35.996577
    ## 97       16140         311        2       544   6.99 2007-01-28 05:31:26.996577
    ## 98       16143         311        2      1128   6.99 2007-01-31 16:17:52.996577
    ## 99       16147         312        2      1079   6.99 2007-01-31 09:16:43.996577
    ## 100      16159         317        1       107   6.99 2007-01-25 16:56:35.996577
    ## 101      16174         326        1       875   6.99 2007-01-30 04:06:50.996577
    ## 102      16177         327        1       653   6.99 2007-01-28 18:40:46.996577
    ## 103      16184         332        1      1000   6.99 2007-01-30 22:54:22.996577
    ## 104      16186         334        1        13   6.99 2007-01-24 22:51:21.996577
    ## 105      16188         337        1       374   6.99 2007-01-27 06:54:56.996577
    ## 106      16208         353        2      1103   6.99 2007-01-31 12:52:44.996577
    ## 107      16230         366        2       911   6.99 2007-01-30 09:18:48.996577
    ## 108      16242         371        2       286   6.99 2007-01-26 18:13:17.996577
    ## 109      16298         399        2       694   6.99 2007-01-29 00:18:09.996577
    ## 110      16301         400        2       171   6.99 2007-01-26 01:42:41.996577
    ## 111      16318         409        1       310   6.99 2007-01-26 21:09:33.996577
    ## 112      16344         427        2        82   6.99 2007-01-25 10:46:12.996577
    ## 113      16370         438        1      1138   6.99 2007-01-31 17:58:53.996577
    ## 114      16377         442        2       558   6.99 2007-01-28 07:07:09.996577
    ## 115      16411         461        1       684   6.99 2007-01-28 22:41:41.996577
    ## 116      16420         468        2       101   6.99 2007-01-25 15:45:30.996577
    ## 117      16422         468        2       296   6.99 2007-01-26 19:03:45.996577
    ## 118      16448         480        1       720   6.99 2007-01-29 03:45:56.996577
    ## 119      16454         483        2       742   6.99 2007-01-29 07:04:56.996577
    ## 120      16464         490        2       585   6.99 2007-01-28 10:19:11.996577
    ## 121      16519         515        2       292   6.99 2007-01-26 18:50:38.996577
    ## 122      16525         520        1       962   6.99 2007-01-30 17:13:43.996577
    ## 123      16555         536        1       929   6.99 2007-01-30 11:01:05.996577
    ## 124      16565         543        1       243   6.99 2007-01-26 11:34:31.996577
    ## 125      16572         546        1       482   6.99 2007-01-27 21:21:28.996577
    ## 126      16576         548        2       177   6.99 2007-01-26 02:42:55.996577
    ## 127      16608         565        1       458   6.99 2007-01-27 18:27:02.996577
    ## 128      16654         594        1      1045   6.99 2007-01-31 04:57:27.996577
    ## 129      16655         595        1       613   6.99 2007-01-28 13:55:48.996577
    ## 130      16661         596        1       974   6.99 2007-01-30 18:57:08.996577
    ## 131      16673         207        2       826   6.99 2007-01-29 20:24:41.996577
    ## 132      16683           5        1      1085   6.99 2007-01-31 09:44:09.996577
    ## 133      16693           8        2       866   6.99 2007-01-30 02:12:20.996577
    ## 134      16698          11        1       987   6.99 2007-01-30 21:27:38.996577
    ## 135      16718          19        1       179   6.99 2007-01-26 02:54:32.996577
    ## 136      16723          20        2       497   6.99 2007-01-27 23:23:05.996577
    ## 137      16734          24        2      1007   6.99 2007-01-30 23:30:54.996577
    ## 138      16749          35        1       424   6.99 2007-01-27 14:02:27.996577
    ## 139      16769          47        1       300   6.99 2007-01-26 19:25:26.996577
    ## 140      16801          56        1       569   6.99 2007-01-28 08:41:07.996577
    ## 141      16834          74        2      1121   6.99 2007-01-31 15:06:02.996577
    ## 142      16854          84        1       739   6.99 2007-01-29 06:56:44.996577
    ## 143      16869          93        2       420   6.99 2007-01-27 13:48:04.996577
    ## 144      16888         105        1       779   6.99 2007-01-29 12:45:43.996577
    ## 145      16921         119        2       540   6.99 2007-01-28 05:08:51.996577
    ## 146      16945         133        1       275   6.99 2007-01-26 15:38:19.996577
    ## 147      16949         134        1       814   6.99 2007-01-29 18:44:38.996577
    ## 148      16983         156        2       899   6.99 2007-01-30 07:57:56.996577
    ## 149      17017         172        1       685   6.99 2007-01-28 22:46:17.996577
    ## 150      17024         176        2       380   6.99 2007-01-27 08:03:05.996577
    ## 151      17029         179        1       759   6.99 2007-01-29 09:26:23.996577
    ## 152      17032         181        2       579   6.99 2007-01-28 09:47:49.996577
    ## 153      17075         201        1       670   6.99 2007-01-28 20:32:29.996577
    ## 154      17097         222        1         5   6.99 2007-01-24 21:33:47.996577
    ## 155      17112         231        1       479   6.99 2007-01-27 21:07:36.996577
    ## 156      17129         239        1       636   6.99 2007-01-28 16:16:24.996577
    ## 157      17149         246        1       124   6.99 2007-01-25 19:14:37.996577
    ## 158      17156         247        1       450   6.99 2007-01-27 17:47:20.996577
    ## 159      17161         249        1       438   6.99 2007-01-27 16:21:00.996577
    ## 160      17176         253        1       566   6.99 2007-01-28 08:20:05.996577
    ## 161      17189         259        2       722   6.99 2007-01-29 03:58:57.996577
    ## 162      17195         261        2       542   6.99 2007-01-28 05:10:39.996577
    ## 163      17203         267        2        91   6.99 2007-01-25 13:25:48.996577
    ## 164      16180         330        2       967   7.99 2007-01-30 17:40:32.996577
    ## 165      16240         369        2       913   7.99 2007-01-30 09:33:24.996577
    ## 166      16275         386        1       583   7.99 2007-01-28 10:17:21.996577
    ## 167      16277         387        1       697   7.99 2007-01-29 00:32:30.996577
    ## 168      16289         391        1       891   7.99 2007-01-30 06:11:38.996577
    ## 169      16314         407        1       619   7.99 2007-01-28 14:20:52.996577
    ## 170      16348         429        2       601   7.99 2007-01-28 12:36:48.996577
    ## 171      16354         432        2       326   7.99 2007-01-26 23:38:37.996577
    ## 172      16360         435        1       757   7.99 2007-01-29 08:58:13.996577
    ## 173      16362         436        1        45   7.99 2007-01-25 04:28:05.996577
    ## 174      16393         449        1       849   7.99 2007-01-29 23:51:33.996577
    ## 175      16401         454        1       735   7.99 2007-01-29 06:36:39.996577
    ## 176      16405         457        2      1024   7.99 2007-01-31 01:58:45.996577
    ## 177      16426         469        2       506   7.99 2007-01-28 00:37:45.996577
    ## 178      16439         474        1       816   7.99 2007-01-29 18:55:05.996577
    ## 179      16446         479        1       709   7.99 2007-01-29 02:16:27.996577
    ## 180      16469         493        1       543   7.99 2007-01-28 05:12:00.996577
    ## 181      16475         497        1      1100   7.99 2007-01-31 12:31:47.996577
    ## 182      16561         541        1      1021   7.99 2007-01-31 01:44:41.996577
    ## 183      16583         550        2       922   7.99 2007-01-30 10:24:21.996577
    ## 184      16584         551        2       155   7.99 2007-01-25 23:43:31.996577
    ## 185      16617         570        2      1060   7.99 2007-01-31 06:50:09.996577
    ## 186      16620         572        2       559   7.99 2007-01-28 07:07:28.996577
    ## 187      16736          25        1        90   7.99 2007-01-25 12:59:51.996577
    ## 188      16805          58        2       276   7.99 2007-01-26 15:44:33.996577
    ## 189      16881         103        1       240   7.99 2007-01-26 11:08:49.996577
    ## 190      16886         105        2       473   7.99 2007-01-27 20:05:00.996577
    ## 191      16899         109        1      1061   7.99 2007-01-31 06:56:24.996577
    ## 192      16902         110        1       515   7.99 2007-01-28 01:38:36.996577
    ## 193      16922         120        2        68   7.99 2007-01-25 08:15:57.996577
    ## 194      16944         131        2       944   7.99 2007-01-30 13:54:50.996577
    ## 195      16966         146        2       762   7.99 2007-01-29 09:44:17.996577
    ## 196      16980         154        2       865   7.99 2007-01-30 02:08:10.996577
    ## 197      17027         176        1      1062   7.99 2007-01-31 07:06:46.996577
    ## 198      17044         187        1       252   7.99 2007-01-26 13:08:19.996577
    ## 199      17054         194        2       677   7.99 2007-01-28 21:28:34.996577
    ## 200      17072         199        1       499   7.99 2007-01-27 23:33:33.996577
    ## 201      17130         239        1      1022   7.99 2007-01-31 01:45:11.996577
    ## 202      17135         241        1       627   7.99 2007-01-28 15:33:09.996577
    ## 203      17145         245        1       519   7.99 2007-01-28 01:50:59.996577
    ## 204      17157         248        2       330   7.99 2007-01-27 00:43:56.996577
    ## 205      16058         271        1      1096   8.99 2007-01-31 11:59:15.996577
    ## 206      16102         293        2      1034   8.99 2007-01-31 03:22:06.996577
    ## 207      16113         299        2       606   8.99 2007-01-28 13:17:05.996577
    ## 208      16154         315        1       537   8.99 2007-01-28 04:49:21.996577
    ## 209      16157         316        1       644   8.99 2007-01-28 17:27:38.996577
    ## 210      16187         334        1       431   8.99 2007-01-27 14:59:31.996577
    ## 211      16190         337        1       839   8.99 2007-01-29 22:56:38.996577
    ## 212      16218         359        1       284   8.99 2007-01-26 17:50:10.996577
    ## 213      16253         375        2       307   8.99 2007-01-26 20:16:39.996577
    ## 214      16268         383        1       766   8.99 2007-01-29 10:15:28.996577
    ## 215      16334         417        2       630   8.99 2007-01-28 15:53:17.996577
    ## 216      16356         432        1       897   8.99 2007-01-30 07:38:27.996577
    ## 217      16357         433        2       146   8.99 2007-01-25 22:35:37.996577
    ## 218      16380         444        1       201   8.99 2007-01-26 05:42:11.996577
    ## 219      16451         482        1       259   8.99 2007-01-26 14:01:12.996577
    ## 220      16459         486        1       909   8.99 2007-01-30 09:12:04.996577
    ## 221      16477         498        1       429   8.99 2007-01-27 14:49:52.996577
    ## 222      16480         500        1       112   8.99 2007-01-25 17:25:50.996577
    ## 223      16481         500        1       389   8.99 2007-01-27 09:14:07.996577
    ## 224      16501         506        1       547   8.99 2007-01-28 05:52:54.996577
    ## 225      16510         509        1       831   8.99 2007-01-29 21:18:51.996577
    ## 226      16511         510        1        75   8.99 2007-01-25 09:42:00.996577
    ## 227      16518         515        2       187   8.99 2007-01-26 04:11:03.996577
    ## 228      16574         547        2       443   8.99 2007-01-27 17:03:46.996577
    ## 229      16640         586        1       900   8.99 2007-01-30 08:07:07.996577
    ## 230      16650         593        1       991   8.99 2007-01-30 21:57:48.996577
    ## 231      16652         594        1       360   8.99 2007-01-27 05:19:40.996577
    ## 232      16663         597        2       514   8.99 2007-01-28 01:37:54.996577
    ## 233      16730          22        2       820   8.99 2007-01-29 19:35:48.996577
    ## 234      16731          23        1       129   8.99 2007-01-25 19:48:29.996577
    ## 235      16849          82        2       288   8.99 2007-01-26 18:16:15.996577
    ## 236      16885         105        1       327   8.99 2007-01-26 23:47:23.996577
    ## 237      16958         142        2        11   8.99 2007-01-24 22:37:28.996577
    ## 238      17092         217        2      1141   8.99 2007-01-31 18:10:28.996577
    ## 239      17113         231        1       512   8.99 2007-01-28 01:36:16.996577
    ## 240      17148         245        2       948   8.99 2007-01-30 14:12:53.996577
    ## 241      17150         246        2       421   8.99 2007-01-27 13:58:39.996577
    ## 242      17192         260        1      1101   8.99 2007-01-31 12:42:25.996577
    ## 243      16160         318        1       224   9.99 2007-01-26 08:46:53.996577
    ## 244      16161         319        1        15   9.99 2007-01-24 23:07:48.996577
    ## 245      16373         439        1       786   9.99 2007-01-29 13:45:54.996577
    ## 246      16449         480        2       822   9.99 2007-01-29 20:04:26.996577
    ## 247      16618         571        1       228   9.99 2007-01-26 09:22:54.996577
    ## 248      16702          14        1       346   9.99 2007-01-27 03:03:07.996577
    ## 249      16717          19        2       110   9.99 2007-01-25 17:12:15.996577
    ## 250      16790          53        2       856   9.99 2007-01-30 00:29:47.996577
    ## 251      16796          55        1      1027   9.99 2007-01-31 02:14:45.996577
    ## 252      16802          57        2       152   9.99 2007-01-25 23:09:36.996577
    ## 253      16822          67        2       331   9.99 2007-01-27 00:50:52.996577
    ## 254      16828          71        1       272   9.99 2007-01-26 14:55:37.996577
    ## 255      16856          85        1       690   9.99 2007-01-28 23:23:19.996577
    ## 256      16877         101        1       468   9.99 2007-01-27 19:41:36.996577
    ## 257      16882         103        1       658   9.99 2007-01-28 18:51:49.996577
    ## 258      16960         142        1       575   9.99 2007-01-28 09:24:35.996577
    ## 259      17015         171        2       804   9.99 2007-01-29 16:38:50.996577
    ## 260      17073         200        2       270   9.99 2007-01-26 14:49:22.996577
    ## 261      17077         209        2       340   9.99 2007-01-27 02:23:51.996577
    ## 262      16073         276        1       860  10.99 2007-01-30 01:13:42.996577
    ## 263      16125         304        1       135  10.99 2007-01-25 20:27:24.996577
    ## 264      16358         433        1       691  10.99 2007-01-28 23:29:52.996577
    ## 265      16883         104        1       163  10.99 2007-01-26 00:54:49.996577
    ## 266      17055         196        2       106  11.99 2007-01-25 16:46:45.996577

### Exercise 4.3

``` r
dbGetQuery(con, "
SELECT *
FROM payment
WHERE amount > 5 AND amount < 8
ORDER BY amount
")
```

    ##     payment_id customer_id staff_id rental_id amount               payment_date
    ## 1        16068         274        1       394   5.99 2007-01-27 09:54:37.996577
    ## 2        16094         288        2       565   5.99 2007-01-28 07:54:57.996577
    ## 3        16106         296        1       511   5.99 2007-01-28 01:32:30.996577
    ## 4        16112         299        1       332   5.99 2007-01-27 00:55:36.996577
    ## 5        16118         301        2       227   5.99 2007-01-26 09:20:12.996577
    ## 6        16121         302        2        92   5.99 2007-01-25 14:07:12.996577
    ## 7        16139         311        2       274   5.99 2007-01-26 15:17:17.996577
    ## 8        16152         314        1        80   5.99 2007-01-25 10:40:33.996577
    ## 9        16165         321        1       620   5.99 2007-01-28 14:23:11.996577
    ## 10       16171         323        1       878   5.99 2007-01-30 04:17:39.996577
    ## 11       16173         325        1       131   5.99 2007-01-25 20:11:12.996577
    ## 12       16192         339        1       876   5.99 2007-01-30 04:09:48.996577
    ## 13       16196         344        2       813   5.99 2007-01-29 18:43:00.996577
    ## 14       16223         361        1       368   5.99 2007-01-27 06:10:55.996577
    ## 15       16227         364        1       462   5.99 2007-01-27 18:39:02.996577
    ## 16       16228         365        2       120   5.99 2007-01-25 18:06:13.996577
    ## 17       16233         368        1        64   5.99 2007-01-25 07:49:55.996577
    ## 18       16234         368        1       125   5.99 2007-01-25 19:17:16.996577
    ## 19       16244         371        1       384   5.99 2007-01-27 08:46:46.996577
    ## 20       16287         391        1       317   5.99 2007-01-26 21:52:22.996577
    ## 21       16294         396        2       641   5.99 2007-01-28 17:14:13.996577
    ## 22       16297         399        2        10   5.99 2007-01-24 22:30:47.996577
    ## 23       16303         400        2       894   5.99 2007-01-30 06:59:57.996577
    ## 24       16310         404        2      1081   5.99 2007-01-31 09:24:58.996577
    ## 25       16316         408        2        59   5.99 2007-01-25 07:25:08.996577
    ## 26       16342         425        2      1098   5.99 2007-01-31 12:20:14.996577
    ## 27       16346         429        2       150   5.99 2007-01-25 22:57:05.996577
    ## 28       16355         432        1       550   5.99 2007-01-28 06:07:42.996577
    ## 29       16359         434        2       508   5.99 2007-01-28 01:09:16.996577
    ## 30       16364         436        1       848   5.99 2007-01-29 23:48:19.996577
    ## 31       16367         437        1       666   5.99 2007-01-28 20:17:17.996577
    ## 32       16378         442        1       632   5.99 2007-01-28 16:06:16.996577
    ## 33       16392         449        2       325   5.99 2007-01-26 23:38:21.996577
    ## 34       16450         481        2      1109   5.99 2007-01-31 13:40:41.996577
    ## 35       16490         503        1       353   5.99 2007-01-27 04:32:05.996577
    ## 36       16493         504        2       136   5.99 2007-01-25 20:30:56.996577
    ## 37       16512         510        1       372   5.99 2007-01-27 06:42:24.996577
    ## 38       16526         522        2       426   5.99 2007-01-27 14:25:23.996577
    ## 39       16531         525        1       437   5.99 2007-01-27 16:15:48.996577
    ## 40       16537         528        1       533   5.99 2007-01-28 04:43:12.996577
    ## 41       16539         528        2       793   5.99 2007-01-29 15:12:34.996577
    ## 42       16547         533        1       615   5.99 2007-01-28 14:04:18.996577
    ## 43       16548         534        2       304   5.99 2007-01-26 19:49:54.996577
    ## 44       16571         546        1       197   5.99 2007-01-26 05:27:47.996577
    ## 45       16594         556        2       772   5.99 2007-01-29 11:36:32.996577
    ## 46       16603         562        1      1139   5.99 2007-01-31 18:03:18.996577
    ## 47       16605         563        2       773   5.99 2007-01-29 11:46:31.996577
    ## 48       16606         564        2       195   5.99 2007-01-26 05:21:02.996577
    ## 49       16610         566        2       234   5.99 2007-01-26 10:15:46.996577
    ## 50       16630         577        2       291   5.99 2007-01-26 18:49:13.996577
    ## 51       16688           7        2        46   5.99 2007-01-25 04:32:34.996577
    ## 52       16692           7        1      1063   5.99 2007-01-31 07:12:55.996577
    ## 53       16703          14        1       525   5.99 2007-01-28 02:53:59.996577
    ## 54       16755          42        1       635   5.99 2007-01-28 16:15:23.996577
    ## 55       16789          53        2       783   5.99 2007-01-29 13:09:44.996577
    ## 56       16799          56        1       341   5.99 2007-01-27 02:30:08.996577
    ## 57       16809          59        1      1154   5.99 2007-01-31 20:10:35.996577
    ## 58       16843          77        1       760   5.99 2007-01-29 09:35:51.996577
    ## 59       16864          89        1       740   5.99 2007-01-29 06:59:02.996577
    ## 60       16865          91        2       216   5.99 2007-01-26 07:46:09.996577
    ## 61       16866          92        1       271   5.99 2007-01-26 14:50:27.996577
    ## 62       16891         107        1       170   5.99 2007-01-26 01:39:38.996577
    ## 63       16892         107        1      1026   5.99 2007-01-31 02:13:52.996577
    ## 64       16895         109        1       203   5.99 2007-01-26 05:56:23.996577
    ## 65       16918         118        2       351   5.99 2007-01-27 04:07:29.996577
    ## 66       16920         119        1       235   5.99 2007-01-26 10:19:35.996577
    ## 67       16931         124        2      1130   5.99 2007-01-31 16:42:23.996577
    ## 68       16938         128        2       888   5.99 2007-01-30 05:41:40.996577
    ## 69       16951         135        1        78   5.99 2007-01-25 10:03:44.996577
    ## 70       16976         151        2       418   5.99 2007-01-27 13:41:43.996577
    ## 71       16979         154        1       469   5.99 2007-01-27 19:42:52.996577
    ## 72       16981         154        2       978   5.99 2007-01-30 19:59:18.996577
    ## 73       16988         158        1       293   5.99 2007-01-26 18:55:28.996577
    ## 74       16995         161        1       520   5.99 2007-01-28 01:56:03.996577
    ## 75       17013         170        1       377   5.99 2007-01-27 07:32:31.996577
    ## 76       17021         174        1        41   5.99 2007-01-25 03:40:55.996577
    ## 77       17045         189        2      1117   5.99 2007-01-31 14:43:57.996577
    ## 78       17056         196        2       178   5.99 2007-01-26 02:50:12.996577
    ## 79       17076         201        2       756   5.99 2007-01-29 08:57:11.996577
    ## 80       17111         231        1       329   5.99 2007-01-27 00:25:40.996577
    ## 81       17131         239        2      1082   5.99 2007-01-31 09:30:27.996577
    ## 82       17151         246        2       434   5.99 2007-01-27 15:22:53.996577
    ## 83       17163         250        1        61   5.99 2007-01-25 07:30:23.996577
    ## 84       17180         254        1      1108   5.99 2007-01-31 13:33:38.996577
    ## 85       17191         259        1      1147   5.99 2007-01-31 19:06:18.996577
    ## 86       16052         269        2       678   6.99 2007-01-28 21:44:14.996577
    ## 87       16060         272        1       405   6.99 2007-01-27 12:01:05.996577
    ## 88       16061         272        1      1041   6.99 2007-01-31 04:14:49.996577
    ## 89       16074         277        2       308   6.99 2007-01-26 20:30:05.996577
    ## 90       16082         282        2       282   6.99 2007-01-26 17:24:52.996577
    ## 91       16086         284        1      1145   6.99 2007-01-31 18:42:11.996577
    ## 92       16087         286        2        81   6.99 2007-01-25 10:43:45.996577
    ## 93       16092         288        2       427   6.99 2007-01-27 14:38:30.996577
    ## 94       16130         306        2       672   6.99 2007-01-28 20:33:55.996577
    ## 95       16134         307        1       970   6.99 2007-01-30 18:18:54.996577
    ## 96       16136         309        2       218   6.99 2007-01-26 07:55:35.996577
    ## 97       16140         311        2       544   6.99 2007-01-28 05:31:26.996577
    ## 98       16143         311        2      1128   6.99 2007-01-31 16:17:52.996577
    ## 99       16147         312        2      1079   6.99 2007-01-31 09:16:43.996577
    ## 100      16159         317        1       107   6.99 2007-01-25 16:56:35.996577
    ## 101      16174         326        1       875   6.99 2007-01-30 04:06:50.996577
    ## 102      16177         327        1       653   6.99 2007-01-28 18:40:46.996577
    ## 103      16184         332        1      1000   6.99 2007-01-30 22:54:22.996577
    ## 104      16186         334        1        13   6.99 2007-01-24 22:51:21.996577
    ## 105      16188         337        1       374   6.99 2007-01-27 06:54:56.996577
    ## 106      16208         353        2      1103   6.99 2007-01-31 12:52:44.996577
    ## 107      16230         366        2       911   6.99 2007-01-30 09:18:48.996577
    ## 108      16242         371        2       286   6.99 2007-01-26 18:13:17.996577
    ## 109      16298         399        2       694   6.99 2007-01-29 00:18:09.996577
    ## 110      16301         400        2       171   6.99 2007-01-26 01:42:41.996577
    ## 111      16318         409        1       310   6.99 2007-01-26 21:09:33.996577
    ## 112      16344         427        2        82   6.99 2007-01-25 10:46:12.996577
    ## 113      16370         438        1      1138   6.99 2007-01-31 17:58:53.996577
    ## 114      16377         442        2       558   6.99 2007-01-28 07:07:09.996577
    ## 115      16411         461        1       684   6.99 2007-01-28 22:41:41.996577
    ## 116      16420         468        2       101   6.99 2007-01-25 15:45:30.996577
    ## 117      16422         468        2       296   6.99 2007-01-26 19:03:45.996577
    ## 118      16448         480        1       720   6.99 2007-01-29 03:45:56.996577
    ## 119      16454         483        2       742   6.99 2007-01-29 07:04:56.996577
    ## 120      16464         490        2       585   6.99 2007-01-28 10:19:11.996577
    ## 121      16519         515        2       292   6.99 2007-01-26 18:50:38.996577
    ## 122      16525         520        1       962   6.99 2007-01-30 17:13:43.996577
    ## 123      16555         536        1       929   6.99 2007-01-30 11:01:05.996577
    ## 124      16565         543        1       243   6.99 2007-01-26 11:34:31.996577
    ## 125      16572         546        1       482   6.99 2007-01-27 21:21:28.996577
    ## 126      16576         548        2       177   6.99 2007-01-26 02:42:55.996577
    ## 127      16608         565        1       458   6.99 2007-01-27 18:27:02.996577
    ## 128      16654         594        1      1045   6.99 2007-01-31 04:57:27.996577
    ## 129      16655         595        1       613   6.99 2007-01-28 13:55:48.996577
    ## 130      16661         596        1       974   6.99 2007-01-30 18:57:08.996577
    ## 131      16673         207        2       826   6.99 2007-01-29 20:24:41.996577
    ## 132      16683           5        1      1085   6.99 2007-01-31 09:44:09.996577
    ## 133      16693           8        2       866   6.99 2007-01-30 02:12:20.996577
    ## 134      16698          11        1       987   6.99 2007-01-30 21:27:38.996577
    ## 135      16718          19        1       179   6.99 2007-01-26 02:54:32.996577
    ## 136      16723          20        2       497   6.99 2007-01-27 23:23:05.996577
    ## 137      16734          24        2      1007   6.99 2007-01-30 23:30:54.996577
    ## 138      16749          35        1       424   6.99 2007-01-27 14:02:27.996577
    ## 139      16769          47        1       300   6.99 2007-01-26 19:25:26.996577
    ## 140      16801          56        1       569   6.99 2007-01-28 08:41:07.996577
    ## 141      16834          74        2      1121   6.99 2007-01-31 15:06:02.996577
    ## 142      16854          84        1       739   6.99 2007-01-29 06:56:44.996577
    ## 143      16869          93        2       420   6.99 2007-01-27 13:48:04.996577
    ## 144      16888         105        1       779   6.99 2007-01-29 12:45:43.996577
    ## 145      16921         119        2       540   6.99 2007-01-28 05:08:51.996577
    ## 146      16945         133        1       275   6.99 2007-01-26 15:38:19.996577
    ## 147      16949         134        1       814   6.99 2007-01-29 18:44:38.996577
    ## 148      16983         156        2       899   6.99 2007-01-30 07:57:56.996577
    ## 149      17017         172        1       685   6.99 2007-01-28 22:46:17.996577
    ## 150      17024         176        2       380   6.99 2007-01-27 08:03:05.996577
    ## 151      17029         179        1       759   6.99 2007-01-29 09:26:23.996577
    ## 152      17032         181        2       579   6.99 2007-01-28 09:47:49.996577
    ## 153      17075         201        1       670   6.99 2007-01-28 20:32:29.996577
    ## 154      17097         222        1         5   6.99 2007-01-24 21:33:47.996577
    ## 155      17112         231        1       479   6.99 2007-01-27 21:07:36.996577
    ## 156      17129         239        1       636   6.99 2007-01-28 16:16:24.996577
    ## 157      17149         246        1       124   6.99 2007-01-25 19:14:37.996577
    ## 158      17156         247        1       450   6.99 2007-01-27 17:47:20.996577
    ## 159      17161         249        1       438   6.99 2007-01-27 16:21:00.996577
    ## 160      17176         253        1       566   6.99 2007-01-28 08:20:05.996577
    ## 161      17189         259        2       722   6.99 2007-01-29 03:58:57.996577
    ## 162      17195         261        2       542   6.99 2007-01-28 05:10:39.996577
    ## 163      17203         267        2        91   6.99 2007-01-25 13:25:48.996577
    ## 164      16180         330        2       967   7.99 2007-01-30 17:40:32.996577
    ## 165      16240         369        2       913   7.99 2007-01-30 09:33:24.996577
    ## 166      16275         386        1       583   7.99 2007-01-28 10:17:21.996577
    ## 167      16277         387        1       697   7.99 2007-01-29 00:32:30.996577
    ## 168      16289         391        1       891   7.99 2007-01-30 06:11:38.996577
    ## 169      16314         407        1       619   7.99 2007-01-28 14:20:52.996577
    ## 170      16348         429        2       601   7.99 2007-01-28 12:36:48.996577
    ## 171      16354         432        2       326   7.99 2007-01-26 23:38:37.996577
    ## 172      16360         435        1       757   7.99 2007-01-29 08:58:13.996577
    ## 173      16362         436        1        45   7.99 2007-01-25 04:28:05.996577
    ## 174      16393         449        1       849   7.99 2007-01-29 23:51:33.996577
    ## 175      16401         454        1       735   7.99 2007-01-29 06:36:39.996577
    ## 176      16405         457        2      1024   7.99 2007-01-31 01:58:45.996577
    ## 177      16426         469        2       506   7.99 2007-01-28 00:37:45.996577
    ## 178      16439         474        1       816   7.99 2007-01-29 18:55:05.996577
    ## 179      16446         479        1       709   7.99 2007-01-29 02:16:27.996577
    ## 180      16469         493        1       543   7.99 2007-01-28 05:12:00.996577
    ## 181      16475         497        1      1100   7.99 2007-01-31 12:31:47.996577
    ## 182      16561         541        1      1021   7.99 2007-01-31 01:44:41.996577
    ## 183      16583         550        2       922   7.99 2007-01-30 10:24:21.996577
    ## 184      16584         551        2       155   7.99 2007-01-25 23:43:31.996577
    ## 185      16617         570        2      1060   7.99 2007-01-31 06:50:09.996577
    ## 186      16620         572        2       559   7.99 2007-01-28 07:07:28.996577
    ## 187      16736          25        1        90   7.99 2007-01-25 12:59:51.996577
    ## 188      16805          58        2       276   7.99 2007-01-26 15:44:33.996577
    ## 189      16881         103        1       240   7.99 2007-01-26 11:08:49.996577
    ## 190      16886         105        2       473   7.99 2007-01-27 20:05:00.996577
    ## 191      16899         109        1      1061   7.99 2007-01-31 06:56:24.996577
    ## 192      16902         110        1       515   7.99 2007-01-28 01:38:36.996577
    ## 193      16922         120        2        68   7.99 2007-01-25 08:15:57.996577
    ## 194      16944         131        2       944   7.99 2007-01-30 13:54:50.996577
    ## 195      16966         146        2       762   7.99 2007-01-29 09:44:17.996577
    ## 196      16980         154        2       865   7.99 2007-01-30 02:08:10.996577
    ## 197      17027         176        1      1062   7.99 2007-01-31 07:06:46.996577
    ## 198      17044         187        1       252   7.99 2007-01-26 13:08:19.996577
    ## 199      17054         194        2       677   7.99 2007-01-28 21:28:34.996577
    ## 200      17072         199        1       499   7.99 2007-01-27 23:33:33.996577
    ## 201      17130         239        1      1022   7.99 2007-01-31 01:45:11.996577
    ## 202      17135         241        1       627   7.99 2007-01-28 15:33:09.996577
    ## 203      17145         245        1       519   7.99 2007-01-28 01:50:59.996577
    ## 204      17157         248        2       330   7.99 2007-01-27 00:43:56.996577

# Exercise 5

``` r
dbGetQuery(con, "PRAGMA table_info(customer)"
)
```

    ##    cid        name    type notnull dflt_value pk
    ## 1    0 customer_id INTEGER       0         NA  0
    ## 2    1    store_id INTEGER       0         NA  0
    ## 3    2  first_name    TEXT       0         NA  0
    ## 4    3   last_name    TEXT       0         NA  0
    ## 5    4       email    TEXT       0         NA  0
    ## 6    5  address_id INTEGER       0         NA  0
    ## 7    6  activebool    TEXT       0         NA  0
    ## 8    7 create_date    TEXT       0         NA  0
    ## 9    8 last_update    TEXT       0         NA  0
    ## 10   9      active INTEGER       0         NA  0

``` r
dbGetQuery(con, "
SELECT c.customer_id, c.last_name, p.payment_id, p.amount
FROM customer AS c INNER JOIN payment AS p
  ON c.customer_id = p.customer_id
WHERE c.last_name == 'Davis'
")
```

    ## [1] customer_id last_name   payment_id  amount     
    ## <0 rows> (or 0-length row.names)

# Exercise 6

### Exercise 6.1

``` r
dbGetQuery(con, "
SELECT 
  COUNT(*) AS count
FROM rental
")
```

    ##   count
    ## 1 16044

### Exercise 6.2

``` r
dbGetQuery(con, "
SELECT customer_id, COUNT(*) AS count
FROM rental
GROUP BY customer_id
LIMIT 8
")
```

    ##   customer_id count
    ## 1           1    32
    ## 2           2    27
    ## 3           3    26
    ## 4           4    22
    ## 5           5    38
    ## 6           6    28
    ## 7           7    33
    ## 8           8    24

### Exercise 6.3

``` r
dbGetQuery(con, "
SELECT customer_id, COUNT(*) AS count
FROM rental
GROUP BY customer_id
ORDER BY customer_id DESC
LIMIT 8
")
```

    ##   customer_id count
    ## 1         599    19
    ## 2         598    22
    ## 3         597    25
    ## 4         596    28
    ## 5         595    30
    ## 6         594    27
    ## 7         593    26
    ## 8         592    29

``` r
dbGetQuery(con, "
SELECT customer_id, COUNT(*) AS count
FROM rental
GROUP BY customer_id
ORDER BY customer_id ASC
LIMIT 8
")
```

    ##   customer_id count
    ## 1           1    32
    ## 2           2    27
    ## 3           3    26
    ## 4           4    22
    ## 5           5    38
    ## 6           6    28
    ## 7           7    33
    ## 8           8    24

### Exercise 6.4

``` r
dbGetQuery(con, "
SELECT customer_id, COUNT(*) AS count
FROM rental
GROUP BY customer_id
HAVING count > 39
LIMIT 8
")
```

    ##   customer_id count
    ## 1          75    41
    ## 2         144    42
    ## 3         148    46
    ## 4         197    40
    ## 5         236    42
    ## 6         469    40
    ## 7         526    45

# Exercise 7

``` r
dbGetQuery(con, "
SELECT MAX(amount) AS maxpayment, 
       MIN(amount) AS minpayment,
       AVG(amount) AS avgpayment,
       SUM(amount) AS sumpayment
FROM payment
")
```

    ##   maxpayment minpayment avgpayment sumpayment
    ## 1      11.99       0.99   4.169775    4824.43

### Exercise 7.1

``` r
dbGetQuery(con, "
SELECT customer_id, 
       MAX(amount) AS maxpayment, 
       MIN(amount) AS minpayment,
       AVG(amount) AS avgpayment,
       SUM(amount) AS sumpayment
FROM payment
GROUP BY customer_id
LIMIT 5
")
```

    ##   customer_id maxpayment minpayment avgpayment sumpayment
    ## 1           1       2.99       0.99   1.990000       3.98
    ## 2           2       4.99       4.99   4.990000       4.99
    ## 3           3       2.99       1.99   2.490000       4.98
    ## 4           5       6.99       0.99   3.323333       9.97
    ## 5           6       4.99       0.99   2.990000       8.97

### Exercise 7.2

``` r
dbGetQuery(con, "
SELECT customer_id, COUNT(*) AS N, 
       MAX(amount) AS maxpayment, 
       MIN(amount) AS minpayment,
       AVG(amount) AS avgpayment,
       SUM(amount) AS sumpayment
FROM payment
GROUP BY customer_id
HAVING N > 5
ORDER BY N
")
```

    ##    customer_id N maxpayment minpayment avgpayment sumpayment
    ## 1           19 6       9.99       0.99   4.490000      26.94
    ## 2           53 6       9.99       0.99   4.490000      26.94
    ## 3          161 6       5.99       0.99   2.990000      17.94
    ## 4          207 6       6.99       0.99   2.990000      17.94
    ## 5          239 6       7.99       2.99   5.656667      33.94
    ## 6          245 6       8.99       0.99   4.823333      28.94
    ## 7          251 6       4.99       1.99   3.323333      19.94
    ## 8          269 6       6.99       0.99   3.156667      18.94
    ## 9          274 6       5.99       2.99   4.156667      24.94
    ## 10         371 6       6.99       0.99   4.323333      25.94
    ## 11         596 6       6.99       0.99   3.823333      22.94
    ## 12         109 7       7.99       0.99   3.990000      27.93
    ## 13         506 7       8.99       0.99   4.132857      28.93
    ## 14         197 8       3.99       0.99   2.615000      20.92

# Cleanup

``` r
dbDisconnect(con)
```
